# Wav-Normalizer

## Project Description

This project aims to create a volume normalization program for music files in the `.WAV` format. The program processes input audio files with varying volume levels to achieve a consistent volume level across all sections. The audio file contains stereo tracks (left and right), and the program processes each track independently to produce a normalized stereo track.

There are two versions of the program:
- One implemented solely in the C programming language.
- Another combining C with some assembly functions, offering potential performance optimizations and smaller binary sizes.

## Audio Processing Methodology

1. **Reading and Parsing**: The program reads the header information of the input `.WAV` file to identify various parameters like the audio format, number of channels, sample rate, and other important information.
2. **Data Processing**: Upon reaching the "data" subchunk, which contains the actual audio samples, the program reads the floating-point audio data for the left and right channels into separate arrays.
3. **Block Processing**: The audio data is divided into blocks, each representing a duration of 100 milliseconds. For each block, the algorithm calculates the average volume by computing the absolute value of each sample and taking the mean.
4. **Reference Volume**: The algorithm finds the maximum average volume (reference volume) for both the left and right channels separately. These reference volumes represent the highest average volume levels among all blocks.
5. **Amplification Factors**: The algorithm computes amplification factors for each block based on the reference volumes.
6. **Applying Amplification**: The calculated amplification factors are used to modify the audio data in each block independently for the left and right channels.
7. **Writing Modified Data**: The modified floating-point audio data for the left and right channels are written to the output `.WAV` file, creating a new audio file with normalized volume levels.

## C Program Design

- **`main()`**: Serves as the entry point of the program. It opens the input and output `.WAV` files, reads and processes the header information, and processes the audio data.
- **`calculateAverageVolume`**: Calculates the average volume of a block of audio samples.
- **`findReferenceVolume`**: Finds the maximum volume within a block of audio samples.
- **`computeAmplificationFactors`**: Calculates the amplification factors for each block.
- **`applyAmplificationFactor`**: Applies an amplification factor to a block of audio samples.
- **`writeFloatData`**: Writes the floating-point audio data for both channels to an output file.
- **`readFloatData`**: Reads the floating-point audio data for both channels from the input file.

## C + Assembly Program Design

The combined C and assembly program optimizes the performance of the volume normalization algorithm by leveraging assembly functions.

- **`calculateAverageVolume`**: Uses the FPU for efficient calculations and handles end-of-sample cases.
- **`findReferenceVolume`**: Uses the FPU to find the maximum volume efficiently.
- **`computeAmplificationFactors`**: Uses the FPU to calculate amplification factors based on the reference volume.
- **`applyAmplificationFactor`**: Applies amplification factors to audio samples.

## C vs Assembly Execution Times

Assembly code is typically faster due to hardware-specific optimizations and more efficient algorithms. Here are the average execution times for key functions:

| Function                     | C          | Assembly   |
|------------------------------|------------|------------|
| `calculateAverageVolume()`   | 159.500 ms | 108.000 ms |
| `findReferenceVolume()`      | 18.000 µs  | 9.667 µs   |
| `computeAmplificationFactors()` | 31.500 µs | 18.000 µs  |
| `applyAmplificationFactor()` | 92.000 ms  | 68.333 ms  |

Overall, the assembly versions are consistently faster.

## C vs Assembly File Size

Comparing the sizes of the compiled/assembled object files:

| Program        | File           | Size        |
|----------------|----------------|-------------|
| C + Assembly   | `Assembly.obj` | 4,119 bytes |
| C              | `cfunctions.obj` | 14,596 bytes |
| C + Assembly   | `candasm.exe`  | 13,312 bytes|
| C              | `onlyc.exe`    | 14,336 bytes|

The assembly version occupies significantly less space, highlighting its efficiency in terms of memory requirements and code size.

## Normalized Audio Results

Both versions of the program achieved the desired audio normalization effectively. The output generated by both programs is compatible with standard audio players and exhibits satisfactory audio quality with no apparent distortions. Both versions demonstrate a consistent and uniform volume profile when analyzed in an audio editor, indicating a successful normalization process.
